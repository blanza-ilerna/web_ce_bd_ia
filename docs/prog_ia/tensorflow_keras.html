<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="TensorFlow y Keras - Frameworks de Deep Learning para Crear Redes Neuronales - iLERNA">
    <meta name="keywords" content="TensorFlow, Keras, Deep Learning, Redes Neuronales, CNN, Transfer Learning, iLERNA">
    <meta name="author" content="Bjlanza">
    <meta name="organization" content="ILERNA">
    <title>TensorFlow y Keras | Programaci√≥n de IA | iLERNA</title>
    <link rel="stylesheet" href="../css/lecciones.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="../css/mermaid-ilerna.css">
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.5/dist/mermaid.min.js"></script>
    <script src="../js/mermaid-config.js"></script>
</head>

<body>
    <header>
        <div class="header-container">
            <div class="logo-container">
                <a href="../index.html">
                    <img src="../img/logo-ilerna.svg" alt="Logo iLERNA">
                </a>
                <div class="logo-text">
                    Curso de Especializaci√≥n
                    <span>Inteligencia Artificial y Big Data</span>
                </div>
            </div>
            <nav class="breadcrumb">
                <a href="../index.html">Inicio</a> ‚Üí
                <a href="index.html">Programaci√≥n IA</a> ‚Üí
                <span>TensorFlow y Keras</span>
            </nav>
        </div>
    </header>

    <main class="container">
        <div class="hero">
            <h1>TensorFlow y Keras</h1>
            <p class="subtitle">Frameworks de Deep Learning para Crear Redes Neuronales</p>
        </div>

        <!-- SECCI√ìN 1: INTRODUCCI√ìN -->
        <section class="section">
            <h2>¬øQu√© son TensorFlow y Keras?</h2>
            <p>
                <strong>TensorFlow</strong> es una plataforma de c√≥digo abierto desarrollada por Google Brain para
                machine learning y deep learning. Lanzada en 2015, se ha convertido en el framework m√°s popular para
                construir redes neuronales y modelos de IA a escala industrial.
            </p>
            <p>
                <strong>Keras</strong> es una API de alto nivel integrada en TensorFlow que simplifica la creaci√≥n de
                redes neuronales. Dise√±ada por Fran√ßois Chollet en 2015, permite construir modelos complejos con pocas
                l√≠neas de c√≥digo, manteniendo la flexibilidad de TensorFlow.
            </p>

            <div class="highlight-box primary">
                <p class="title">Ejemplo Real:</p>
                <p class="content">Google utiliza TensorFlow en m√°s de 100 productos: Google Photos (reconocimiento
                    facial), Google Translate (traducci√≥n neuronal), Gmail (sugerencias inteligentes) y YouTube
                    (recomendaciones). DeepMind us√≥ TensorFlow para entrenar AlphaGo, la IA que venci√≥ al campe√≥n
                    mundial de Go.</p>
            </div>

            <h3>Conceptos Fundamentales</h3>
            <div class="grid-features">
                <div class="feature-card primary">
                    <h4 class="color-primary">Tensores</h4>
                    <p>Estructuras de datos multidimensionales (escalares, vectores, matrices, n-dimensionales) que
                        almacenan y procesan informaci√≥n.</p>
                </div>
                <div class="feature-card secondary">
                    <h4 class="color-secondary">Grafos Computacionales</h4>
                    <p>Representaci√≥n de operaciones matem√°ticas como nodos conectados, optimizando c√°lculos y
                        permitiendo diferenciaci√≥n autom√°tica.</p>
                </div>
                <div class="feature-card primary">
                    <h4 class="color-primary">Capas (Layers)</h4>
                    <p>Bloques de construcci√≥n de redes neuronales: Dense, Conv2D, LSTM, Dropout. Cada capa transforma
                        los datos de entrada.</p>
                </div>
                <div class="feature-card secondary">
                    <h4 class="color-secondary">Backpropagation</h4>
                    <p>Algoritmo que ajusta los pesos de la red propagando el error desde la salida hacia las capas
                        anteriores para minimizar la p√©rdida.</p>
                </div>
            </div>
        </section>

        <!-- SECCI√ìN 2: ARQUITECTURA TENSORFLOW -->
        <section class="section">
            <h2>Arquitectura de TensorFlow</h2>

            <h3>Stack Tecnol√≥gico Completo</h3>
            <div class="svg-container">
                <svg width="850" height="500" viewBox="0 0 850 500" style="max-width: 100%; height: auto;">
                    <!-- T√≠tulo -->
                    <text x="425" y="30" font-size="20" font-weight="bold" fill="#49B9CE" text-anchor="middle"
                        font-family="Montserrat, sans-serif">Arquitectura en Capas de TensorFlow</text>

                    <!-- CAPA 1: APIs de Alto Nivel -->
                    <rect x="100" y="60" width="650" height="70" fill="#E8F7FA" stroke="#49B9CE" stroke-width="3"
                        rx="8" />
                    <text x="425" y="85" font-size="16" font-weight="bold" fill="#49B9CE" text-anchor="middle"
                        font-family="Montserrat, sans-serif">APIs de Alto Nivel</text>
                    <text x="425" y="105" font-size="13" fill="#333333" text-anchor="middle"
                        font-family="Montserrat, sans-serif">Keras API - tf.estimator - TensorFlow Hub</text>
                    <text x="425" y="122" font-size="11" fill="#555555" text-anchor="middle"
                        font-family="Montserrat, sans-serif">F√°cil de usar - Modelos pre-entrenados - Construcci√≥n
                        r√°pida</text>

                    <!-- Flecha -->
                    <path d="M 425 130 L 425 145" stroke="#49B9CE" stroke-width="2" marker-end="url(#arrowblue)"
                        fill="none" />

                    <!-- CAPA 2: Core TensorFlow -->
                    <rect x="100" y="150" width="650" height="70" fill="#A3E0EA" stroke="#1e7e9c" stroke-width="3"
                        rx="8" />
                    <text x="425" y="175" font-size="16" font-weight="bold" fill="#1e7e9c" text-anchor="middle"
                        font-family="Montserrat, sans-serif">Core TensorFlow</text>
                    <text x="425" y="195" font-size="13" fill="#333333" text-anchor="middle"
                        font-family="Montserrat, sans-serif">Python API - Eager Execution - AutoGraph - Datasets</text>
                    <text x="425" y="212" font-size="11" fill="#555555" text-anchor="middle"
                        font-family="Montserrat, sans-serif">Control total - Debugging - Optimizaci√≥n
                        personalizada</text>

                    <!-- Flecha -->
                    <path d="M 425 220 L 425 235" stroke="#1e7e9c" stroke-width="2" marker-end="url(#arrowdarkblue)"
                        fill="none" />

                    <!-- CAPA 3: C++ Engine -->
                    <rect x="100" y="240" width="650" height="70" fill="#F0EDF5" stroke="#8A7AAF" stroke-width="3"
                        rx="8" />
                    <text x="425" y="265" font-size="16" font-weight="bold" fill="#8A7AAF" text-anchor="middle"
                        font-family="Montserrat, sans-serif">Motor C++ / CUDA</text>
                    <text x="425" y="285" font-size="13" fill="#333333" text-anchor="middle"
                        font-family="Montserrat, sans-serif">Operaciones de bajo nivel - Optimizaci√≥n -
                        Paralelizaci√≥n</text>
                    <text x="425" y="302" font-size="11" fill="#555555" text-anchor="middle"
                        font-family="Montserrat, sans-serif">Rendimiento m√°ximo - GPU/TPU - Distribuci√≥n</text>

                    <!-- Flecha -->
                    <path d="M 425 310 L 425 325" stroke="#8A7AAF" stroke-width="2" marker-end="url(#arrowpurple)"
                        fill="none" />

                    <!-- CAPA 4: Hardware -->
                    <rect x="100" y="330" width="650" height="70" fill="#C5B9D8" stroke="#6b5b95" stroke-width="3"
                        rx="8" />
                    <text x="425" y="355" font-size="16" font-weight="bold" fill="#6b5b95" text-anchor="middle"
                        font-family="Montserrat, sans-serif">Capa de Hardware</text>
                    <text x="425" y="375" font-size="13" fill="#333333" text-anchor="middle"
                        font-family="Montserrat, sans-serif">CPU - GPU (NVIDIA CUDA) - TPU (Google) - Edge
                        Devices</text>
                    <text x="425" y="392" font-size="11" fill="#555555" text-anchor="middle"
                        font-family="Montserrat, sans-serif">Escalable desde m√≥vil hasta supercomputadoras</text>

                    <!-- Anotaciones laterales -->
                    <text x="780" y="95" font-size="10" fill="#49B9CE" font-family="Montserrat, sans-serif"
                        font-weight="bold">Para usuarios</text>
                    <text x="780" y="185" font-size="10" fill="#1e7e9c" font-family="Montserrat, sans-serif"
                        font-weight="bold">Para expertos</text>
                    <text x="780" y="275" font-size="10" fill="#8A7AAF" font-family="Montserrat, sans-serif"
                        font-weight="bold">Interna</text>
                    <text x="780" y="365" font-size="10" fill="#6b5b95" font-family="Montserrat, sans-serif"
                        font-weight="bold">F√≠sica</text>

                    <!-- Cuadro info -->
                    <rect x="50" y="420" width="750" height="65" fill="#FFF8DC" stroke="#FFA726" stroke-width="2"
                        rx="5" />
                    <text x="425" y="440" font-size="12" font-weight="bold" fill="#E65100" text-anchor="middle"
                        font-family="Montserrat, sans-serif">Ventaja Clave</text>
                    <text x="425" y="458" font-size="11" fill="#555555" text-anchor="middle"
                        font-family="Montserrat, sans-serif">Puedes empezar con Keras (alto nivel) y descender a
                        TensorFlow Core cuando necesites</text>
                    <text x="425" y="473" font-size="11" fill="#555555" text-anchor="middle"
                        font-family="Montserrat, sans-serif">control total, manteniendo compatibilidad en toda la
                        arquitectura</text>

                    <!-- Definiciones de flechas -->
                    <defs>
                        <marker id="arrowblue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto"
                            markerUnits="strokeWidth">
                            <path d="M0,0 L0,6 L9,3 z" fill="#49B9CE" />
                        </marker>
                        <marker id="arrowdarkblue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto"
                            markerUnits="strokeWidth">
                            <path d="M0,0 L0,6 L9,3 z" fill="#1e7e9c" />
                        </marker>
                        <marker id="arrowpurple" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto"
                            markerUnits="strokeWidth">
                            <path d="M0,0 L0,6 L9,3 z" fill="#8A7AAF" />
                        </marker>
                    </defs>
                </svg>
            </div>

            <h3>Caracter√≠sticas Principales</h3>
            <div class="grid-features">
                <div class="feature-card primary">
                    <h4 class="color-primary">Eager Execution</h4>
                    <p>Evaluaci√≥n inmediata de operaciones, facilitando debugging y prototipado r√°pido.</p>
                </div>
                <div class="feature-card secondary">
                    <h4 class="color-secondary">GPU/TPU Support</h4>
                    <p>Aceleraci√≥n autom√°tica en GPUs NVIDIA y TPUs de Google sin cambiar c√≥digo.</p>
                </div>
                <div class="feature-card primary">
                    <h4 class="color-primary">TensorFlow.js</h4>
                    <p>Ejecuta modelos directamente en el navegador o Node.js para aplicaciones web.</p>
                </div>
                <div class="feature-card secondary">
                    <h4 class="color-secondary">TensorFlow Lite</h4>
                    <p>Versi√≥n optimizada para dispositivos m√≥viles (Android/iOS) y edge computing.</p>
                </div>
            </div>
        </section>

        <!-- SECCI√ìN 3: KERAS API -->
        <section class="section">
            <h2>Keras: La API de Alto Nivel</h2>

            <p>
                Keras proporciona tres formas de construir modelos: <strong>Sequential</strong> (capas apiladas),
                <strong>Functional API</strong> (grafos complejos) y <strong>Model Subclassing</strong> (orientado a
                objetos). El 90% de casos se resuelven con Sequential y Functional.
            </p>

            <h3>1. Modelo Sequential: Red Neuronal B√°sica</h3>
            <p>
                El modelo m√°s simple para arquitecturas lineales donde cada capa tiene exactamente una entrada y una
                salida.
            </p>

            <pre><code class="language-python">import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np

# Crear modelo secuencial para clasificaci√≥n de d√≠gitos MNIST
model = keras.Sequential([
    # Capa de entrada: aplanar im√°genes 28x28 a vector 784
    layers.Flatten(input_shape=(28, 28)),

    # Capa oculta 1: 128 neuronas con activaci√≥n ReLU
    layers.Dense(128, activation='relu', name='hidden_1'),

    # Dropout: regularizaci√≥n para evitar overfitting (20%)
    layers.Dropout(0.2),

    # Capa oculta 2: 64 neuronas
    layers.Dense(64, activation='relu', name='hidden_2'),

    # Capa de salida: 10 clases (d√≠gitos 0-9) con softmax
    layers.Dense(10, activation='softmax', name='output')
], name='mnist_classifier')

# Compilar modelo: definir optimizador, funci√≥n de p√©rdida y m√©tricas
model.compile(
    optimizer='adam',                              # Adam: optimizador adaptativo
    loss='sparse_categorical_crossentropy',        # Para clasificaci√≥n multiclase
    metrics=['accuracy']                           # M√©trica de evaluaci√≥n
)

# Resumen del modelo: ver arquitectura y par√°metros
model.summary()

# Entrenar modelo (ejemplo con datos sint√©ticos)
X_train = np.random.rand(1000, 28, 28)  # 1000 im√°genes de ejemplo
y_train = np.random.randint(0, 10, 1000)  # Etiquetas aleatorias 0-9

history = model.fit(
    X_train, y_train,
    epochs=10,                    # 10 iteraciones completas sobre los datos
    batch_size=32,                # 32 muestras por actualizaci√≥n
    validation_split=0.2,         # 20% de datos para validaci√≥n
    verbose=1
)

# Predicci√≥n
X_test = np.random.rand(5, 28, 28)
predictions = model.predict(X_test)
print("Probabilidades de cada clase:", predictions[0])</code></pre>

            <div class="highlight-box primary">
                <p class="title">Resultado:</p>
                <p class="content">El modelo tiene ~101,770 par√°metros entrenables. Con MNIST real, alcanza 98%+ de
                    precisi√≥n en 10 epochs.</p>
            </div>

            <h3>2. Functional API: Red Neuronal Convolucional (CNN)</h3>
            <p>
                Para arquitecturas complejas con m√∫ltiples entradas/salidas, conexiones residuales o compartici√≥n de
                capas.
            </p>

            <pre><code class="language-python">import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers

# Definir entrada
inputs = keras.Input(shape=(28, 28, 1), name='input_image')

# Bloque convolucional 1
x = layers.Conv2D(32, kernel_size=3, activation='relu', name='conv1')(inputs)
x = layers.MaxPooling2D(pool_size=2, name='pool1')(x)

# Bloque convolucional 2
x = layers.Conv2D(64, kernel_size=3, activation='relu', name='conv2')(x)
x = layers.MaxPooling2D(pool_size=2, name='pool2')(x)

# Bloque convolucional 3
x = layers.Conv2D(128, kernel_size=3, activation='relu', name='conv3')(x)

# Aplanar para capas densas
x = layers.Flatten(name='flatten')(x)

# Capas densas
x = layers.Dense(128, activation='relu', name='dense1')(x)
x = layers.Dropout(0.5, name='dropout')(x)

# Salida principal: clasificaci√≥n de d√≠gitos
main_output = layers.Dense(10, activation='softmax', name='digit_output')(x)

# Salida auxiliar: predicci√≥n de paridad (par/impar)
aux_output = layers.Dense(2, activation='softmax', name='parity_output')(x)

# Crear modelo con m√∫ltiples salidas
model = keras.Model(
    inputs=inputs,
    outputs=[main_output, aux_output],
    name='cnn_multi_output'
)

# Compilar con diferentes pesos para cada salida
model.compile(
    optimizer='adam',
    loss={
        'digit_output': 'sparse_categorical_crossentropy',
        'parity_output': 'sparse_categorical_crossentropy'
    },
    loss_weights={'digit_output': 1.0, 'parity_output': 0.2},
    metrics=['accuracy']
)

model.summary()

# Ejemplo de entrenamiento
import numpy as np
X_train = np.random.rand(1000, 28, 28, 1)
y_digit = np.random.randint(0, 10, 1000)
y_parity = np.random.randint(0, 2, 1000)  # 0=par, 1=impar

history = model.fit(
    X_train,
    {'digit_output': y_digit, 'parity_output': y_parity},
    epochs=5,
    batch_size=32
)</code></pre>

            <div class="highlight-box secondary">
                <p class="title">Resultado:</p>
                <p class="content">CNN con ~168,000 par√°metros. Identifica d√≠gitos Y su paridad simult√°neamente con
                    arquitectura compartida.</p>
            </div>

            <h3>Arquitectura de la CNN</h3>
            <div class="svg-container">
                <svg width="900" height="450" viewBox="0 0 900 450" style="max-width: 100%; height: auto;">
                    <!-- T√≠tulo -->
                    <text x="450" y="25" font-size="18" font-weight="bold" fill="#49B9CE" text-anchor="middle"
                        font-family="Montserrat, sans-serif">Red Neuronal Convolucional (CNN) - Flujo de Datos</text>

                    <!-- INPUT -->
                    <rect x="50" y="50" width="80" height="120" fill="#E8F7FA" stroke="#49B9CE" stroke-width="3"
                        rx="5" />
                    <text x="90" y="100" font-size="12" font-weight="bold" fill="#333333" text-anchor="middle"
                        font-family="Montserrat, sans-serif">INPUT</text>
                    <text x="90" y="120" font-size="10" fill="#555555" text-anchor="middle"
                        font-family="Montserrat, sans-serif">28x28x1</text>
                    <text x="90" y="135" font-size="9" fill="#777777" text-anchor="middle"
                        font-family="Montserrat, sans-serif">Imagen</text>
                    <text x="90" y="150" font-size="9" fill="#777777" text-anchor="middle"
                        font-family="Montserrat, sans-serif">Grayscale</text>

                    <!-- CONV1 -->
                    <rect x="160" y="40" width="90" height="140" fill="#A3E0EA" stroke="#49B9CE" stroke-width="2"
                        rx="5" />
                    <text x="205" y="95" font-size="11" font-weight="bold" fill="#333333" text-anchor="middle"
                        font-family="Montserrat, sans-serif">CONV2D</text>
                    <text x="205" y="110" font-size="10" fill="#555555" text-anchor="middle"
                        font-family="Montserrat, sans-serif">32 filtros 3x3</text>
                    <text x="205" y="125" font-size="9" fill="#777777" text-anchor="middle"
                        font-family="Montserrat, sans-serif">26x26x32</text>
                    <text x="205" y="145" font-size="8" fill="#49B9CE" font-weight="bold" text-anchor="middle"
                        font-family="Montserrat, sans-serif">+ ReLU</text>
                    <text x="205" y="160" font-size="8" fill="#777777" text-anchor="middle"
                        font-family="Montserrat, sans-serif">+ MaxPool 2x2</text>

                    <!-- CONV2 -->
                    <rect x="280" y="40" width="90" height="140" fill="#A3E0EA" stroke="#49B9CE" stroke-width="2"
                        rx="5" />
                    <text x="325" y="95" font-size="11" font-weight="bold" fill="#333333" text-anchor="middle"
                        font-family="Montserrat, sans-serif">CONV2D</text>
                    <text x="325" y="110" font-size="10" fill="#555555" text-anchor="middle"
                        font-family="Montserrat, sans-serif">64 filtros 3x3</text>
                    <text x="325" y="125" font-size="9" fill="#777777" text-anchor="middle"
                        font-family="Montserrat, sans-serif">11x11x64</text>
                    <text x="325" y="145" font-size="8" fill="#49B9CE" font-weight="bold" text-anchor="middle"
                        font-family="Montserrat, sans-serif">+ ReLU</text>
                    <text x="325" y="160" font-size="8" fill="#777777" text-anchor="middle"
                        font-family="Montserrat, sans-serif">+ MaxPool 2x2</text>

                    <!-- CONV3 -->
                    <rect x="400" y="50" width="90" height="120" fill="#A3E0EA" stroke="#49B9CE" stroke-width="2"
                        rx="5" />
                    <text x="445" y="100" font-size="11" font-weight="bold" fill="#333333" text-anchor="middle"
                        font-family="Montserrat, sans-serif">CONV2D</text>
                    <text x="445" y="115" font-size="10" fill="#555555" text-anchor="middle"
                        font-family="Montserrat, sans-serif">128 filtros 3x3</text>
                    <text x="445" y="130" font-size="9" fill="#777777" text-anchor="middle"
                        font-family="Montserrat, sans-serif">3x3x128</text>
                    <text x="445" y="150" font-size="8" fill="#49B9CE" font-weight="bold" text-anchor="middle"
                        font-family="Montserrat, sans-serif">+ ReLU</text>

                    <!-- FLATTEN -->
                    <rect x="520" y="60" width="70" height="100" fill="#F0EDF5" stroke="#8A7AAF" stroke-width="2"
                        rx="5" />
                    <text x="555" y="100" font-size="11" font-weight="bold" fill="#8A7AAF" text-anchor="middle"
                        font-family="Montserrat, sans-serif">FLATTEN</text>
                    <text x="555" y="120" font-size="9" fill="#555555" text-anchor="middle"
                        font-family="Montserrat, sans-serif">Vector</text>
                    <text x="555" y="135" font-size="9" fill="#777777" text-anchor="middle"
                        font-family="Montserrat, sans-serif">1152</text>

                    <!-- DENSE -->
                    <rect x="620" y="60" width="70" height="100" fill="#C5B9D8" stroke="#8A7AAF" stroke-width="2"
                        rx="5" />
                    <text x="655" y="95" font-size="11" font-weight="bold" fill="#8A7AAF" text-anchor="middle"
                        font-family="Montserrat, sans-serif">DENSE</text>
                    <text x="655" y="110" font-size="10" fill="#555555" text-anchor="middle"
                        font-family="Montserrat, sans-serif">128 unidades</text>
                    <text x="655" y="130" font-size="8" fill="#8A7AAF" font-weight="bold" text-anchor="middle"
                        font-family="Montserrat, sans-serif">+ ReLU</text>
                    <text x="655" y="145" font-size="8" fill="#777777" text-anchor="middle"
                        font-family="Montserrat, sans-serif">+ Dropout 50%</text>

                    <!-- OUTPUT 1: DIGITS -->
                    <rect x="720" y="40" width="140" height="60" fill="#E8F7FA" stroke="#49B9CE" stroke-width="3"
                        rx="5" />
                    <text x="790" y="60" font-size="12" font-weight="bold" fill="#49B9CE" text-anchor="middle"
                        font-family="Montserrat, sans-serif">OUTPUT: D√≠gito</text>
                    <text x="790" y="75" font-size="10" fill="#555555" text-anchor="middle"
                        font-family="Montserrat, sans-serif">10 clases (0-9)</text>
                    <text x="790" y="90" font-size="9" fill="#777777" text-anchor="middle"
                        font-family="Montserrat, sans-serif">Softmax</text>

                    <!-- OUTPUT 2: PARITY -->
                    <rect x="720" y="120" width="140" height="60" fill="#F0EDF5" stroke="#8A7AAF" stroke-width="3"
                        rx="5" />
                    <text x="790" y="140" font-size="12" font-weight="bold" fill="#8A7AAF" text-anchor="middle"
                        font-family="Montserrat, sans-serif">OUTPUT: Paridad</text>
                    <text x="790" y="155" font-size="10" fill="#555555" text-anchor="middle"
                        font-family="Montserrat, sans-serif">2 clases (par/impar)</text>
                    <text x="790" y="170" font-size="9" fill="#777777" text-anchor="middle"
                        font-family="Montserrat, sans-serif">Softmax</text>

                    <!-- Flechas de flujo -->
                    <path d="M 130 110 L 155 110" stroke="#49B9CE" stroke-width="3" marker-end="url(#arrowblue2)"
                        fill="none" />
                    <path d="M 250 110 L 275 110" stroke="#49B9CE" stroke-width="3" marker-end="url(#arrowblue2)"
                        fill="none" />
                    <path d="M 370 110 L 395 110" stroke="#49B9CE" stroke-width="3" marker-end="url(#arrowblue2)"
                        fill="none" />
                    <path d="M 490 110 L 515 110" stroke="#8A7AAF" stroke-width="3" marker-end="url(#arrowpurple2)"
                        fill="none" />
                    <path d="M 590 110 L 615 110" stroke="#8A7AAF" stroke-width="3" marker-end="url(#arrowpurple2)"
                        fill="none" />
                    <path d="M 690 70 L 715 70" stroke="#49B9CE" stroke-width="2" marker-end="url(#arrowblue2)"
                        fill="none" />
                    <path d="M 690 150 L 715 150" stroke="#8A7AAF" stroke-width="2" marker-end="url(#arrowpurple2)"
                        fill="none" />

                    <!-- Anotaciones -->
                    <text x="450" y="210" font-size="11" fill="#49B9CE" font-weight="bold" text-anchor="middle"
                        font-family="Montserrat, sans-serif">EXTRACCI√ìN DE CARACTER√çSTICAS</text>
                    <line x1="160" y1="215" x2="490" y2="215" stroke="#49B9CE" stroke-width="2" />

                    <text x="655" y="210" font-size="11" fill="#8A7AAF" font-weight="bold" text-anchor="middle"
                        font-family="Montserrat, sans-serif">CLASIFICACI√ìN</text>
                    <line x1="520" y1="215" x2="860" y2="215" stroke="#8A7AAF" stroke-width="2" />

                    <!-- Cuadro explicativo -->
                    <rect x="50" y="240" width="810" height="190" fill="#FFF8DC" stroke="#FFA726" stroke-width="2"
                        rx="8" />
                    <text x="455" y="265" font-size="13" font-weight="bold" fill="#E65100" text-anchor="middle"
                        font-family="Montserrat, sans-serif">C√≥mo Funciona Esta CNN</text>

                    <text x="70" y="290" font-size="11" fill="#333333" font-family="Montserrat, sans-serif"
                        font-weight="bold">1. Convoluciones:</text>
                    <text x="70" y="305" font-size="10" fill="#555555" font-family="Montserrat, sans-serif">- Detectan
                        caracter√≠sticas locales (bordes, texturas, patrones)</text>
                    <text x="70" y="320" font-size="10" fill="#555555" font-family="Montserrat, sans-serif">- Cada capa
                        detecta caracter√≠sticas m√°s complejas</text>

                    <text x="70" y="345" font-size="11" fill="#333333" font-family="Montserrat, sans-serif"
                        font-weight="bold">2. Pooling:</text>
                    <text x="70" y="360" font-size="10" fill="#555555" font-family="Montserrat, sans-serif">- Reduce
                        dimensionalidad manteniendo informaci√≥n importante</text>
                    <text x="70" y="375" font-size="10" fill="#555555" font-family="Montserrat, sans-serif">- A√±ade
                        invariancia a peque√±as traslaciones</text>

                    <text x="470" y="290" font-size="11" fill="#333333" font-family="Montserrat, sans-serif"
                        font-weight="bold">3. Capas Densas:</text>
                    <text x="470" y="305" font-size="10" fill="#555555" font-family="Montserrat, sans-serif">- Combinan
                        caracter√≠sticas para decisi√≥n final</text>
                    <text x="470" y="320" font-size="10" fill="#555555" font-family="Montserrat, sans-serif">- Aprenden
                        relaciones complejas no lineales</text>

                    <text x="470" y="345" font-size="11" fill="#333333" font-family="Montserrat, sans-serif"
                        font-weight="bold">4. Multi-Output:</text>
                    <text x="470" y="360" font-size="10" fill="#555555" font-family="Montserrat, sans-serif">- Permite
                        predicciones m√∫ltiples relacionadas</text>
                    <text x="470" y="375" font-size="10" fill="#555555" font-family="Montserrat, sans-serif">- Comparte
                        representaciones para eficiencia</text>

                    <text x="455" y="400" font-size="10" fill="#E65100" text-anchor="middle"
                        font-family="Montserrat, sans-serif" font-weight="bold">Total: ~168,000 par√°metros entrenables |
                        GPU: ~50ms por batch | CPU: ~200ms</text>
                    <text x="455" y="418" font-size="10" fill="#555555" text-anchor="middle"
                        font-family="Montserrat, sans-serif">Con dataset MNIST completo: 99%+ precisi√≥n en
                        reconocimiento de d√≠gitos</text>

                    <defs>
                        <marker id="arrowblue2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto"
                            markerUnits="strokeWidth">
                            <path d="M0,0 L0,6 L9,3 z" fill="#49B9CE" />
                        </marker>
                        <marker id="arrowpurple2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto"
                            markerUnits="strokeWidth">
                            <path d="M0,0 L0,6 L9,3 z" fill="#8A7AAF" />
                        </marker>
                    </defs>
                </svg>
            </div>
        </section>

        <!-- SECCI√ìN 4: COMPARACI√ìN TENSORFLOW VS KERAS -->
        <section class="section">
            <h2>TensorFlow Core vs Keras API</h2>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Aspecto</th>
                            <th>TensorFlow Core</th>
                            <th>Keras API</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Nivel de Abstracci√≥n</strong></td>
                            <td>Bajo nivel - Control total</td>
                            <td>Alto nivel - API simplificada</td>
                        </tr>
                        <tr>
                            <td><strong>Curva de Aprendizaje</strong></td>
                            <td>Empinada - Requiere expertise</td>
                            <td>Suave - F√°cil de aprender</td>
                        </tr>
                        <tr>
                            <td><strong>Flexibilidad</strong></td>
                            <td>M√°xima - Cualquier arquitectura</td>
                            <td>Alta - 95% de casos cubiertos</td>
                        </tr>
                        <tr>
                            <td><strong>C√≥digo Necesario</strong></td>
                            <td>50-200 l√≠neas t√≠picas</td>
                            <td>10-30 l√≠neas t√≠picas</td>
                        </tr>
                        <tr>
                            <td><strong>Debugging</strong></td>
                            <td>Complejo - Requiere trazado manual</td>
                            <td>Simple - Mensajes claros</td>
                        </tr>
                        <tr>
                            <td><strong>Velocidad de Desarrollo</strong></td>
                            <td>Lenta - Mayor boilerplate</td>
                            <td>R√°pida - Prototipado √°gil</td>
                        </tr>
                        <tr>
                            <td><strong>Rendimiento</strong></td>
                            <td>√ìptimo con optimizaci√≥n manual</td>
                            <td>Excelente - Optimizado autom√°tico</td>
                        </tr>
                        <tr>
                            <td><strong>Casos de Uso</strong></td>
                            <td>Investigaci√≥n avanzada, custom ops</td>
                            <td>Producci√≥n, prototipado, educaci√≥n</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="highlight-box primary">
                <p class="title">Recomendaci√≥n Pr√°ctica</p>
                <p class="content">
                    <strong>Empieza con Keras</strong> para el 90% de tus proyectos. Solo usa TensorFlow Core cuando
                    necesites:
                </p>
                <ul>
                    <li>Operaciones personalizadas no disponibles en Keras</li>
                    <li>Control granular del grafo computacional</li>
                    <li>Optimizaciones extremas de rendimiento</li>
                    <li>Investigaci√≥n de nuevas arquitecturas</li>
                </ul>
            </div>
        </section>

        <!-- SECCI√ìN 5: CASOS DE USO REALES -->
        <section class="section">
            <h2>Aplicaciones en la Industria</h2>

            <div class="grid-features">
                <div class="feature-card primary">
                    <h4 class="color-primary">Google</h4>
                    <p><strong>Google Search:</strong> Procesamiento de lenguaje natural con BERT y embeddings
                        contextuales.</p>
                    <p><strong>Google Photos:</strong> Reconocimiento facial y clasificaci√≥n autom√°tica de 1.5+ billones
                        de fotos.</p>
                    <div class="highlight-box primary">
                        <p class="content">Impacto: 98.7% precisi√≥n en b√∫squeda visual</p>
                    </div>
                </div>

                <div class="feature-card secondary">
                    <h4 class="color-secondary">Netflix</h4>
                    <p><strong>Sistema de recomendaci√≥n:</strong> Redes neuronales profundas para predecir contenido
                        personalizado.</p>
                    <p><strong>Thumbnails personalizados:</strong> CNN para seleccionar la miniatura perfecta por
                        usuario.</p>
                    <div class="highlight-box secondary">
                        <p class="content">Ahorro: $1B/a√±o en retenci√≥n de usuarios</p>
                    </div>
                </div>

                <div class="feature-card primary">
                    <h4 class="color-primary">Uber</h4>
                    <p><strong>Predicci√≥n de demanda:</strong> LSTM para anticipar necesidad de veh√≠culos por zona y
                        hora.</p>
                    <p><strong>Detecci√≥n de fraude:</strong> Anomaly detection con autoencoders.</p>
                    <div class="highlight-box primary">
                        <p class="content">Eficiencia: +40% optimizaci√≥n de flota</p>
                    </div>
                </div>

                <div class="feature-card secondary">
                    <h4 class="color-secondary">Airbnb</h4>
                    <p><strong>Pricing din√°mico:</strong> Deep learning para sugerir precios √≥ptimos basados en 100+
                        variables.</p>
                    <p><strong>Clasificaci√≥n de amenities:</strong> Computer vision para detectar autom√°ticamente
                        caracter√≠sticas.</p>
                    <div class="highlight-box secondary">
                        <p class="content">Resultado: +15% ingresos anfitriones</p>
                    </div>
                </div>

                <div class="feature-card primary">
                    <h4 class="color-primary">Tesla</h4>
                    <p><strong>Autopilot:</strong> M√∫ltiples CNNs para detecci√≥n de objetos, lanes y se√±ales en tiempo
                        real.</p>
                    <p><strong>Occupancy Network:</strong> Red 3D para predecir espacio navegable.</p>
                    <div class="highlight-box primary">
                        <p class="content">Datos: 5 mil millones millas autopilot</p>
                    </div>
                </div>

                <div class="feature-card secondary">
                    <h4 class="color-secondary">Spotify</h4>
                    <p><strong>Discover Weekly:</strong> Collaborative filtering con embeddings neuronales de 80M+
                        canciones.</p>
                    <p><strong>Audio analysis:</strong> CNN para clasificar g√©nero, mood y tempo autom√°ticamente.</p>
                    <div class="highlight-box secondary">
                        <p class="content">Usuarios: 500M+ activos mensuales</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECCI√ìN 6: TRANSFER LEARNING -->
        <section class="section">
            <h2>Transfer Learning con Modelos Pre-entrenados</h2>

            <p>
                El <strong>Transfer Learning</strong> permite reutilizar modelos entrenados en datasets masivos
                (ImageNet: 14M im√°genes) para tareas espec√≠ficas con pocos datos. TensorFlow Hub y Keras Applications
                proporcionan modelos listos para usar.
            </p>

            <h3>Ejemplo: Clasificador de Gatos vs Perros con MobileNetV2</h3>

            <pre><code class="language-python">import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
from tensorflow.keras.applications import MobileNetV2
import numpy as np

# Cargar modelo pre-entrenado en ImageNet (sin top layer)
base_model = MobileNetV2(
    input_shape=(224, 224, 3),
    include_top=False,           # Excluir capa de clasificaci√≥n
    weights='imagenet'            # Pesos pre-entrenados
)

# Congelar capas base (no entrenar estos pesos)
base_model.trainable = False

# Construir modelo completo
inputs = keras.Input(shape=(224, 224, 3))

# Normalizaci√≥n espec√≠fica de MobileNet
x = keras.applications.mobilenet_v2.preprocess_input(inputs)

# Pasar por base model (extractor de caracter√≠sticas)
x = base_model(x, training=False)

# Agregar capas de clasificaci√≥n personalizadas
x = layers.GlobalAveragePooling2D()(x)      # Reducir dimensiones
x = layers.Dropout(0.2)(x)                  # Regularizaci√≥n
outputs = layers.Dense(1, activation='sigmoid')(x)  # Clasificaci√≥n binaria

model = keras.Model(inputs, outputs)

# Compilar
model.compile(
    optimizer=keras.optimizers.Adam(learning_rate=0.0001),
    loss='binary_crossentropy',
    metrics=['accuracy']
)

print(f"Par√°metros totales: {model.count_params():,}")
print(f"Par√°metros entrenables: {sum([tf.size(w).numpy() for w in model.trainable_weights]):,}")

# Simular entrenamiento (en producci√≥n, usar dataset real)
X_train = np.random.rand(100, 224, 224, 3)
y_train = np.random.randint(0, 2, 100)  # 0=gato, 1=perro

history = model.fit(
    X_train, y_train,
    epochs=10,
    batch_size=16,
    validation_split=0.2
)

# FASE 2: Fine-tuning (descongelar √∫ltimas capas)
print("\nDescongelando √∫ltimas 20 capas para fine-tuning...")
base_model.trainable = True

# Congelar todas menos las √∫ltimas 20
for layer in base_model.layers[:-20]:
    layer.trainable = False

# Re-compilar con learning rate menor
model.compile(
    optimizer=keras.optimizers.Adam(learning_rate=0.00001),  # 10x menor
    loss='binary_crossentropy',
    metrics=['accuracy']
)

# Continuar entrenamiento (fine-tuning)
history_fine = model.fit(
    X_train, y_train,
    epochs=5,
    batch_size=16,
    validation_split=0.2
)</code></pre>

            <div class="highlight-box primary">
                <p class="title">Resultado:</p>
                <p class="content">2.3M par√°metros totales, solo 58K entrenables inicialmente. Con dataset real: 95%+
                    precisi√≥n con solo 1,000 im√°genes de entrenamiento.</p>
            </div>

            <h3>Modelos Pre-entrenados Disponibles</h3>
            <div class="grid-features">
                <div class="feature-card">
                    <h4>ResNet50/101/152</h4>
                    <p>Redes residuales profundas. Ideal para clasificaci√≥n de im√°genes general.</p>
                </div>
                <div class="feature-card">
                    <h4>MobileNetV2/V3</h4>
                    <p>Optimizado para m√≥viles y edge devices. Ligero y r√°pido.</p>
                </div>
                <div class="feature-card">
                    <h4>EfficientNet</h4>
                    <p>Estado del arte en eficiencia. Balance √≥ptimo precisi√≥n/velocidad.</p>
                </div>
                <div class="feature-card">
                    <h4>BERT/GPT</h4>
                    <p>Para NLP. Procesamiento de lenguaje natural y transformers.</p>
                </div>
            </div>
        </section>

        <section class="section">
            <div class="curiosity-box">
                <h4>üí° Dato Curioso: El Origen de TensorFlow</h4>

                <p>
                    TensorFlow fue desarrollado internamente en Google como <strong>DistBelief</strong> (2011), el
                    sistema que entren√≥ el famoso "Google Cat" - una red neuronal que aprendi√≥ a reconocer gatos en
                    videos de YouTube sin supervisi√≥n. En 2015, Google decidi√≥ liberar TensorFlow como open source.
                </p>

                <div class="highlight-box primary">
                    <p class="title">Hitos importantes:</p>
                    <ul>
                        <li><strong>2015:</strong> Lanzamiento p√∫blico de TensorFlow 1.0</li>
                        <li><strong>2017:</strong> Keras integrado oficialmente en TensorFlow</li>
                        <li><strong>2019:</strong> TensorFlow 2.0 - Eager execution por defecto</li>
                        <li><strong>2024:</strong> M√°s de <strong>170,000 stars</strong> en GitHub</li>
                        <li><strong>Comunidad:</strong> 2,600+ contribuidores activos</li>
                    </ul>
                </div>

                <div class="highlight-box secondary">
                    <p class="content text-center">
                        TensorFlow procesa m√°s de <strong>25 petabytes</strong> de datos diariamente en los servidores
                        de Google, entrenando miles de modelos simult√°neamente en TPUs (Tensor Processing Units), chips
                        dise√±ados espec√≠ficamente para acelerar operaciones con tensores.
                    </p>
                </div>
            </div>
        </section>

        <!-- RESUMEN VISUAL CON MERMAID -->
        <section class="section">
            <h2 class="section-title">Resumen Visual</h2>
            <div class="mindmap-container">
                <pre class="mermaid">
mindmap
  root((TF y Keras))
    Conceptos
      Tensores
      Grafos
      Capas
    Arquitectura
      Keras Alto Nivel
      TF Core Bajo Nivel
      Motor C++ CUDA
      Hardware GPU TPU
    Modelos Keras
      Sequential
      Functional API
      Subclassing
    Ecosistema
      TensorFlow.js
      TensorFlow Lite
      TensorFlow Hub
    Tecnicas
      Transfer Learning
      Fine-tuning
                </pre>
            </div>
        </section>
    </main>

    <footer>
        <h3>iLERNA</h3>
        <p class="footer-course">Curso de Especializaci√≥n en Inteligencia Artificial y Big Data</p>
        <a href="https://www.ilerna.es/" target="_blank">www.ilerna.es</a>
        <p class="footer-info">Centro oficial de FP online y presencial. Ciclos formativos de Grado Medio y Grado
            Superior.</p>
        <p class="footer-info">Titulaciones 100% oficiales. ¬°Sin pruebas libres!</p>

        <div class="penguin">
            <span>üêß</span>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="../js/lecciones.js"></script>
</body>

</html>